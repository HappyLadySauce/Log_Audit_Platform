# 安全日志审计平台（综合日志审计分析平台）- 功能实现与演练方案

## 1. 项目背景与核心要求

本次项目旨在构建一个纯前端实现的安全日志审计平台。为达到高保真演示效果，需利用前端状态管理技术（如 Pinia），精确模拟与后端服务的数据交互、状态变更及异步流程。

核心要求是**"无痕模拟"**：所有界面、交互、数据动态，都应表现得如同真实接入了后端服务，让使用者无法感知其为前端模拟。平台将预设部分网络设备作为基础数据，演示的核心流程是现场添加服务器与K8S集群资产，配置并触发告警，最终完成告警的响应与处理归档。

## 2. 平台功能实现细则

### 2.1. 资产管理模块

此模块负责管理平台监控的所有IT资产。

**1. 资产列表与添加**

*   **网络设备 (预设数据)**: 平台初始化时，资产列表中应包含以下预设的网络设备信息，状态均为"正常"。

| 设备名称 | 设备类型 | IP地址 | 位置 | 安全防护等级 |
| :--- | :--- | :--- | :--- | :--- |
| `Core-Switch-01` | 核心交换机 | `192.168.1.1` | 数据中心A栋 | 等级三 |
| `Firewall-Main` | 防火墙 | `10.0.0.1` | 互联网入口 | 等级三 |
| `Access-Switch-Branch` | 接入交换机 | `192.168.10.1` | 分部机房 | 等级二 |

*   **服务器资产添加 (现场演示功能)**:
    *   提供"添加资产"按钮，点击后弹出表单，支持下拉菜单点击。
    *   表单字段包括：
        *   **设备名称**: (输入框，例如 `K8S-Master-Node1`)
        *   **设备类型**: (下拉选择：`Linux服务器`, `Windows服务器`)
        *   **IP地址**: (输入框，带格式校验)
        *   **位置**: (输入框，例如 `数据中心B栋`)
        *   **安全防护等级**: (下拉选择：`等级一`, `等级二`, `等级三`)
    *   提交后，新服务器将出现在资产列表中，初始状态为"正常"。这些数据将被存入前端状态管理器中。

![](image/安全防护等级1.png)
![](image/安全防护等级2.png)
![](image/安全防护等级3.png)

### 2.2. 日志采集模块

此模块模拟对不同资产的日志采集过程。

**1. 服务器日志采集**

*   **自动发现**: 在"日志采集 > 服务器"页面，提供一个"**开始扫描**"按钮。
*   **模拟扫描**: 点击按钮后，显示一个加载动画或进度条，模拟正在网络中发现新设备。1-2秒后，动画结束，"发现"在【资产管理】中新添加的服务器，并将其显示在列表中。
*   **采集状态**: 服务器列表应有一列"采集状态"，初始为"采集中..."，几秒后变为"已连接 - 实时采集中"，并显示一个绿色的动态图标，增强真实感。
*   **查看详情**: 点击任一服务器可进入详情页，展示该服务器的模拟日志流。

![](image/服务器日志采集.png)

**2. 集群日志采集**

*   **集群接入**: 在"日志采集 > Kubernetes"页面，提供"**接入新集群**"功能。
*   **接入表单**: 点击后弹出表单，要求输入"**集群名称**"和"**Kube-apiserver 地址**"。
*   **模拟接入**: 点击"确定"后，模拟网络连接和认证过程（可显示"正在验证连接..."提示）。数秒后，提示"集群 `[集群名称]` 接入成功"，并将其添加至集群列表。
*   **Pod 详情页 (核心)**:
    *   点击集群可查看Pod列表。点击任一Pod，进入详情页。
    *   **页面布局**: 严格按照 `基本信息`、`容器详情`、`实时日志` 单页面区域布局，移除其他无关模块。
    *   **基本信息**: 展示Pod的静态信息，如 `名称`, `命名空间`, `节点IP`, `状态` 等。
    *   **容器详情**: 展示容器列表及其状态。
    *   **实时日志 (重点)**: 此区域应模拟一个终端窗口，每隔1-2秒自动滚动刷新，动态追加新的、格式逼真的模拟日志条目，例如：
        ```
        2023-10-27T10:00:05.123Z [info] Request received: GET /api/v1/health
        2023-10-27T10:00:05.125Z [info] Health check successful
        2023-10-27T10:00:07.456Z [warn] High CPU usage detected on container 'webapp'
        ```

![](image/pod1.png)
![](image/pod2.png)
![](image/pod3.png)

### 2.3. 日志与告警管理模块

**1. 日志记录分类**

*   在"日志管理"主页面，为所有汇聚的日志增加"**日志类型**"字段，并提供基于此字段的筛选功能。
*   建议类型包括：`安全审计`, `系统操作`, `应用异常`, `网络流量`, `K8S事件`。

![](image/日志记录.png)

**2. 告警规则配置 (核心模拟)**

*   在"告警管理 > 规则管理"页面，**仅保留以下两条预设规则**，删除所有其他规则。
    1.  **规则一**:
        *   **名称**: `核心网络设备离线告警`
        *   **监控对象**: 网络设备 - `Access-Switch-Branch`
        *   **触发条件**: `连续5分钟未收到心跳` (文字描述即可)
        *   **告警等级**: `严重`
    2.  **规则二**:
        *   **名称**: `K8S集群API Server无响应`
        *   **监控对象**: K8S集群 - `分部K8S集群` (演示时接入的集群)
        *   **触发条件**: `Kube-apiserver 连接超时` (文字描述)
        *   **告警等级**: `严重`

![](image/告警规则管理.png)

**3. 告警记录与处理流程**

*   **页面布局**: 在"告警管理 > 告警记录"页面，顶部设置醒目的卡片式分类导航，如 `待处理 (2)`, `处理中 (0)`, `已处理 (5)`。数字需要动态变化。
*   **故障触发与告警生成**:
    *   见下方【全局控制】。当"**触发故障**"被点击时，系统将自动生成上述两条规则对应的告警，并将其显示在"待处理"列表中。同时，顶部"待处理"卡片的数字会增加 `2`。
*   **告警处理**:
    *   在"待处理"列表中，点击告警的"处理"按钮。
    *   告警状态变为"处理中"，并流转至"处理中"列表。
*   **故障恢复与告警归档**:
    *   当"**修复故障**"被点击时，对应的告警会自动从"处理中"消失。
    *   此时，点击"已处理"卡片，会跳转到已处理列表，并看到刚刚修复的告警。
    *   点击该已处理告警的"归档"按钮，弹出"**告警处理归档**"表单。
    *   **归档表单**: 包含字段 `处理人` (自动填充当前用户), `处理时间` (自动填充), `根本原因分析`, `解决方案`, `遗留问题`。填写后提交，完成归档。

![](image/告警记录查询.png)

**4. 全局模拟控制**

*   在系统界面的顶部导航栏或一个不显眼的角落，设置两个全局控制按钮：
    1.  `[触发故障]`
    2.  `[修复故障]`
*   这两个按钮是整个演示的核心，它们直接操作 Pinia 的全局状态。
    *   **点击 [触发故障]**:
        1.  将 `Access-Switch-Branch` 和 `分部K8S集群` 的资产状态更新为"异常/红色"。
        2.  在告警记录中新增两条待处理告警。
        3.  (可选) 在相关资产的详情页中，注入能反映故障的模拟日志。
    *   **点击 [修复故障]**:
        1.  将上述资产的状态恢复为"正常/绿色"。
        2.  将对应的告警状态从未处理/处理中更新为已解决，并移入"已处理"分类的背后数据源中。

![](image/顶部按钮.png)

### 2.4. AI 智能分析模块

1.  **导航顺序**: 将"上网流量审计"导航项移动到"AI智能分析"之前。
2.  **AI分析报告 (模拟)**:
    *   此页面用于展示AI分析的能力。
    *   提供一个"**生成本周安全态势分析报告**"按钮。
    *   点击后，显示加载动画和提示："AI大模型正在分析海量日志，请稍候..."。
    *   3-5秒后，显示一份预设好的、图文并茂的静态分析报告。报告应包含：
        *   **安全评分**: 例如 `92分`。
        *   **威胁趋势图**: 一张看似动态的图表（可使用Chart.js等库绘制静态数据）。
        *   **主要发现**: 文字描述，如"检测到来自XX的恶意扫描IP..."、"`K8S-Master-Node1` 存在XX漏洞风险..."。
        *   **优化建议**: 列出几条具体的安全建议。

## 3. 故障排错应急演练流程 (演示剧本)

此环节旨在通过角色扮演，串联平台功能，展示应急响应的全过程。

| 步骤 | 角色 | 操作/对话 | 平台功能联动 |
| :--- | :--- | :--- | :--- |
| 1 | **负责人** | "演练开始。模拟生产环境 `Access-Switch-Branch` 交换机和 `分部K8S集群` 同时发生故障。" (说罢，**点击全局 `[触发故障]` 按钮**) | 1. 资产状态变红。<br>2. 平台发出告警声（可选）。<br>3. 告警记录页面出现两条新告警。 |
| 2 | **系统分析师** | "收到！平台已检测到告警。" (迅速切换到 **告警记录查询** 页面) "我看到一条核心网络设备离线告警和一条K8S集群API Server无响应告警。正在分析。" | 展示"待处理"列表中的两条严重告警。 |
| 3 | **系统分析师** | (在企业微信/钉钉等外部聊天工具中) "@项目负责人 @网络工程师 @系统架构师，平台捕获到严重告警，截图如下，请立即响应！" (发送告警页面的截图) | 演示如何从平台获取关键信息并用于外部协作。 |
| 4 | **项目负责人** | (在聊天工具中) "收到。网络工程师负责排查交换机问题，系统架构师负责K8S集群。立即行动！" | - |
| 5 | **工程师 (模拟排障)** | (过一段时间后) 网络工程师："交换机已重启，恢复正常。" 系统架构师："K8S API Server已恢复。" | - |
| 6 | **负责人** | "好，故障已排除。" (说罢，**点击全局 `[修复故障]` 按钮**) | 1. 资产状态恢复为绿色。<br>2. 告警从未处理中消失。 |
| 7 | **系统分析师** | "我正在确认。平台显示资产状态已恢复正常，告警已自动清除。" (刷新页面或等待数据更新) "现在，我需要对这两个故障进行处理归档。" | 导航到"已处理"告警列表，找到刚刚恢复的告警。 |
| 8 | **系统分析师** | (点击告警的"归档"按钮) "正在填写故障处理记录...根本原因是...解决方案是..." (现场填写并提交表单) | 演示告警处理的闭环流程，将临时告警转化为知识沉淀。 |
| 9 | **项目负责人** | "很好。分析师归档的同时，网络工程师和系统架构师请完成设备标签的更新和打印。" | - |
| 10 | **网络工程师** | (在聊天工具中) "收到，我已在前期准备好设备命名及编辑，现进行标签打印。" | - |
| 11 | **项目负责人** | "所有流程已完成。我将汇总所有电子和纸质记录，本次应急演练结束。" | - |
